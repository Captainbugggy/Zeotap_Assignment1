<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Spreadsheet Application</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
</head>
<body>
    <header>
        <nav class="navbar">
            <h1>Advanced Spreadsheet</h1>
            <div class="toolbar">
                <button onclick="applyStyle('bold')" title="Bold">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M15.6 11.79c.97-.67 1.65-1.77 1.65-2.79 0-2.26-1.75-4-4-4H7v14h7.04c2.09 0 3.71-1.7 3.71-3.79 0-1.52-.86-2.82-2.15-3.42zM10 7.5h3c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-3v-3zm3.5 9H10v-3h3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5z"/>
                    </svg>
                    Bold
                </button>
                <button onclick="applyStyle('italic')" title="Italic">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4z"/>
                    </svg>
                    Italic
                </button>
                <button onclick="applyStyle('underline')" title="Underline">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 17c3.31 0 6-2.69 6-6V3h-2.5v8c0 1.93-1.57 3.5-3.5 3.5S8.5 12.93 8.5 11V3H6v8c0 3.31 2.69 6 6 6zm-7 2v2h14v-2H5z"/>
                    </svg>
                    Underline
                </button>
                <button title="Text Color">
                    <input type="color" onchange="applyColor(this.value)" id="colorPicker">
                    <label for="colorPicker">Text Color</label>
                </button>
                <button onclick="addColumn()" title="Add Column">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                    </svg>
                    Add Column
                </button>
                <button onclick="addRow()" title="Add Row">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                    </svg>
                    Add Row
                </button>
                <button onclick="deleteRow(selectedRowIndex)" title="Delete Selected">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                  </svg>
                  Delete Selected Row
                </button>
             
                <button onclick="deleteColumn(selectedColumnIndex)" title="Delete Selected Column">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M19 5v14H5V5h14zm-2 2H7v10h10V7z"/>
                  </svg>
                  Delete Selected Column
                </button>
                
              </button>
            </div>
        </nav>
    </header>

    <main>
        <div class="controls">
            <input 
                id="formulaBar" 
                type="text" 
                placeholder="Enter formula or value (e.g., =SUM(A1:A5))" 
                oninput="applyFormula()"
            >
            <button onclick="applyFormula()">Apply</button>
             <!-- Add Find and Replace UI -->
             <button onclick="promptUserForFindAndReplace()">Find and Replace</button>
        </div>

        <div id="spreadsheet-container">
            <div id="spreadsheet">
                <!-- Cells will be dynamically generated by JavaScript -->
            </div>
        </div>

        <div id="dataValidationMessage"></div>

        <div class="save-load">
            <button onclick="saveSpreadsheet()">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z"/>
                </svg>
                Save Spreadsheet
            </button>
            <div class="file-input-wrapper">
                <input type="file" id="loadFile" onchange="loadSpreadsheet(event)" accept=".xlsx,.xls">
                <label for="loadFile">Load Spreadsheet</label>
            </div>
        </div>

    </main>

    <script src="script.js"></script>
</body>
</html